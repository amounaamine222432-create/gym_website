<div class="container py-2">

  <h2 class="fw-bold mb-4 text-center">ğŸ‹ï¸â€â™‚ï¸ Mes Cours</h2>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
  </div>

  <div class="row g-4">

    <div class="col-md-4" *ngFor="let cours of tousCours">

      <div class="card shadow-sm h-100 border-0 rounded-4 overflow-hidden">

        <img [src]="cours.photo"
             alt="{{ cours.titre }}"
             class="card-img-top"
             style="height:190px; object-fit:cover;">

        <div class="card-body">
          <h5 class="card-title fw-bold">{{ cours.titre }}</h5>
          <p class="text-muted small">{{ cours.categorie }} â€¢ {{ cours.niveau }}</p>
          <p class="card-text" style="height: 70px; overflow: hidden;">
            {{ cours.description }}
          </p>
        </div>

        <div class="card-footer bg-white border-0 pb-4 text-center">

          <button *ngIf="!estInscrit(cours.id)"
                  class="btn btn-success px-4 rounded-pill"
                  (click)="participer(cours.id)">
            Participer âœ“
          </button>

          <div *ngIf="estInscrit(cours.id)">
            <button class="btn btn-primary px-4 rounded-pill me-2"
        (click)="openCoachsModal(cours)">
  Choisir Coach ğŸ‘¨â€ğŸ«
</button>


            <button class="btn btn-danger px-4 rounded-pill"
                    (click)="quitter(cours.id)">
              Quitter âœ•
            </button>
          </div>

        </div>

      </div>

    </div>
  </div>
</div>


<!-- ============================= -->
<!-- ğŸ”¥ MODAL BOOTSTRAP : COACHS -->
<!-- ============================= -->

<div class="modal" id="coachModal" tabindex="-1" style="display:none;background:rgba(0,0,0,.6);">
  <div class="modal-dialog modal-lg">
    <div class="modal-content rounded-4 shadow-lg">

      <div class="modal-header">
        <h5 class="modal-title fw-bold">Choisir un coach pour : {{ selectedCours?.titre }}</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>

      <div class="modal-body">

        <!-- Liste des coachs -->
        <div class="row g-3">

          <div class="col-md-4" *ngFor="let coach of coachs">
            <div class="card h-100 shadow-sm rounded-4 text-center p-2">

              <img [src]="'assets/coachs/' + coach.photo"
                   class="rounded-circle mb-2"
                   width="90" height="90"
                   style="object-fit:cover;">

              <h6 class="fw-bold">{{ coach.nom }} {{ coach.prenom }}</h6>
              <p class="text-muted small">{{ coach.specialite }}</p>

              <button class="btn btn-outline-primary btn-sm rounded-pill"
                      (click)="choisirCoach(coach.id)">
                Choisir
              </button>

            </div>
          </div>

        </div>

        <hr class="my-4" *ngIf="selectedCoach">

    <!-- Liste des sÃ©ances -->
<div *ngIf="selectedCoach" class="mt-4">

  <h5 class="fw-bold text-center mb-3">
    SÃ©ances disponibles
  </h5>

  <!-- Aucune sÃ©ance -->
  <div *ngIf="seances.length === 0" class="text-danger text-center">
    âŒ Aucune sÃ©ance planifiÃ©e pour ce coach.
  </div>

  <!-- Cartes des sÃ©ances -->
  <div class="row g-3" *ngIf="seances.length > 0">
    <div class="col-md-4" *ngFor="let s of seances">
      <div class="card p-3 shadow-sm rounded-4">
        <h6 class="fw-bold">
          {{ s.date_seance | date:'EEEE dd MMMM':'fr' }}
        </h6>

        <div class="text-muted small">
          {{ s.heure_debut }} â†’ {{ s.heure_fin }}
        </div>

        <div class="small mb-2">
          Salle : {{ s.salle }}
        </div>

       <button class="btn btn-success btn-sm w-100"
        (click)="reserver(s.id)">
  RÃ©server
</button>

      </div>
    </div>
  </div>
    <!-- â­ FORMULAIRE AVIS ICI -->
  <div class="mt-4 p-3 bg-light rounded-4 shadow-sm">
    <app-review-form
  *ngIf="selectedCours && selectedCoach"
  [coursId]="selectedCours.id"
  [coachId]="selectedCoach.id">
</app-review-form>
  </div>

</div>
